{% extends "base.html" %}
{% block title %}Rent Prediction{% endblock %}
{% block content %}
<div class="container mt-5">
    <h2>Predict Rent</h2>
    <form method="POST" class="row g-2 align-items-end bg-light p-3 rounded">
        {{ form.hidden_tag() }}
        <div class="col-md-2">{{ form.size.label(class="form-label") }}{{ form.size(class="form-control", placeholder="Size (sqft)") }}</div>
        <div class="col-md-1">{{ form.bedroom.label(class="form-label") }}{{ form.bedroom(class="form-control", placeholder="BHK") }}</div>
        <div class="col-md-1">{{ form.bathroom.label(class="form-label") }}{{ form.bathroom(class="form-control", placeholder="Bath") }}</div>
        <div class="col-md-2">{{ form.city.label(class="form-label") }}{{ form.city(class="form-select") }}</div>
        <div class="col-md-2">{{ form.furnishing_status.label(class="form-label") }}{{ form.furnishing_status(class="form-select") }}</div>
        <div class="col-md-2">{{ form.tenant_preferred.label(class="form-label") }}{{ form.tenant_preferred(class="form-select") }}</div>
        <div class="col-md-2">{{ form.area_type.label(class="form-label") }}{{ form.area_type(class="form-select") }}</div>
        <div class="col-md-1"><button type="submit" class="btn btn-vibrant w-100">Predict</button></div>
    </form>
    {% if predicted_rent %}
        <div class="d-flex justify-content-center mt-4 mb-2">
            <div class="w-100" style="display: flex; align-items: center; justify-content: center;">
                <span style="background: #17a2b8; color: #fff; border-radius: 30px; font-size: 1.3rem; padding: 0.75rem 2rem; width: 100%; text-align: center;">
                    <strong>Predicted Rent:</strong> ₹{{ predicted_rent | round(2) }}
                </span>
            </div>
        </div>
        <div class="alert alert-secondary mt-2 text-center" style="border-radius: 20px;">
            Showing properties in the price range ₹{{ (predicted_rent * 0.9) | round(2) }} - ₹{{ (predicted_rent * 1.1) | round(2) }}
        </div>
        <h4 class="mt-4">Matching Properties</h4>
        <div class="row">
            {% for prop in properties %}
                <div class="col-md-4">
                    <div class="card mb-3">
                        <div class="card-body">
                            <h5><i class="fas fa-home text-primary"></i> {{ prop.title }}</h5>
                            <p><i class="fas fa-map-marker-alt"></i> {{ prop.address }}, {{ prop.city }}</p>
                            <p><i class="fas fa-rupee-sign"></i> ₹{{ prop.price }}</p>
                            <a href="{{ url_for('property_detail', property_id=prop.id) }}" class="btn btn-vibrant">View Details</a>
                        </div>
                    </div>
                </div>
            {% else %}
                <p>No properties found in this price range.</p>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endblock %}